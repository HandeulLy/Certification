# 2-1-2 DDL



DDL(Data Definition Language)

\- 데이터 정의어, 데이터베이스를 정의하는 언어

\- 생성/수정/삭제 등 데이터의 전체적인 골격을 결정하는 역할



# 1. 데이터 유형

​    \- 데이터 유형은 데이터베이스의 테이블에 특정 자료를 입력할 때, 자료의 유형별로 나누는 기준

​    \- 특정 칼럼을 정의할 때 선언한 데이터 유형은 그 칼럼이 받아들일 수 있는 자료의 유형(타입과 크기)을 규정한다

​    \- 선언한 유형이 아니거나 크기를 벗어난 데이터가 들어오면 에러를 발생시킨다

| **데이터 유형** | **설명**                                                     |
| --------------- | ------------------------------------------------------------ |
| **CHAR**        | 고정 길이 문자열 정보s만큼 최대 길이를 갖고, 할당된 변수 값의 길이가 s보다 작은 경우 공백으로 채움 |
| **VARCHAR**     | 가변 길이 문자열 정보s만큼 최대 길이를 갖지만 가변 길이로 조정되기 때문에 할당된 변수 값의 바이트만 적용 |
| **NUMERIC**     | 정수, 실수 등 숫자 정보                                      |
| **DATETIME**    | 날짜와 시각 정보                                             |

​    \- CHAR vs VARCHAR

​    1) 저장 영역 : VARCHAR 유형은 가변 길이이기 때문에 실제 데이터 크기만큼만 필요하다(길이가 다양한 칼럼이나 정의된 길이와 실제 데이터 길이에 차이가 있는 칼럼에 적합)

​    2) 문자열 비교 방법 : CHAR는 문자열을 비교할 때 공백을 채워서 비교한다. 끝의 공백만 다른 문자열은 같다고 판단하지만 VARCHAR는 공백도 하나의 문자로 취급하기 때문에 끝에 공백이 다르면 다른 문자로 판단한다



# 2. CREATE TABLE

\- 테이블 생성을 위해 테이블에 입력될 데이터를 정의하고, 데이터 유형과 크기를 어떻게 선언할지 결정해야 한다

****

**가. 테이블과 칼럼 정의**

​    \- 기본키 칼럼 지정 : 테이블에 존재하는 모든 데이터를 고유하게 식별할 수 있으면서 반드시 값이 존재하는 단일 칼럼이나 칼럼의 조합 중 하나를 선정

​    \- 테이블 간의 관계 : 기본키와 외부키를 활용해서 테이블과 테이블 사이의 관계를 설정한다

**나. CREATE TABLE**

​    \- 테이블 생성 구문 : *CREATE TABLE 테이블이름*

​                                     *(컬럼명1 DATATYPE[DEFAULT 형식], 컬럼명2 DATATYPE[DEFAULT 형식], ... );*

​    \- 테이블 생성 시 주의해야 할 규칙 : 테이블명은 객체를 의미하는 단수형 단어를 사용한다, 다른 테이블명과 중복되지 않아야 한다, 한 테이블 내에서는 칼럼명이 중복되게 지정될 수 없다, 칼럼 뒤에 데이터 유형은 반드시 지정되어야 한다, 테이블명과 칼럼명은 반드시 문자로 시작해야 하고 길이 제한이 있다, SQL에서 정의한 예약어는 쓸 수 없다, 특수문자는 허용되지 않는다, 테이블 생성 시 대/소문자 구분은 없다, DATATIME 유형에는 별도로 크기를 지정하지 않는다, 문제형은 최대 길이를 표시해야 한다, 칼럼에 제약조건이 있으면 CONSTRAINT를 이용하여 추가한다

**다. 제약조건(CONSTRAINT)**

​    \- 사용자가 원하는 조건의 데이터만 유지하기 위해 테이블의 특정 칼럼에 설정하는 제약(for 데이터 무결성 유지)

| **제약조건 구분** | **설명**                                                     |
| ----------------- | ------------------------------------------------------------ |
| **PK**            | 테이블에 저장된 행 데이터를 고유하게 식별하기 위한 기본키(NOT NULL)기본키 제약을 정의하면 DBMS는 자동으로 'UNIQUE 인덱스를생성 + NOT NULL' |
| **FK**            | 관계형 데이터베이스에서 테이블 간의 관계를 정의하기 위해 기본키를 다른 테이블의 외래키로 복사하는 경우 생성 됨 |
| **UNIQUE KEY**    | 테이블에 저장된 행 데이터를 고유하게 식별하기 위한 고유키 정의단, NULL은 고유키 제약 대상이 아니기 때문에 NULL 값인 행이 많더라도 위반되지 않음 |
| **NOT NULL**      | NULL 값의 입력을 금지DEFAULT 상태는 모든 칼럼에 NULL을 허가하지만, 이 조건을 지정하면 입력 필수 |
| **CHECK**         | 입력할 수 있는 값의 범위 등을 제한(True or False로 평가할 수 있는 논리식을 지정) |

​    \- NULL과 공백은 다른 값, 널은 '아직 정의되지 않은 미지의 값'이나 '현재 데이터를 입력하지 못한 경우'를 의미

​    \- 데이터의 기본 값 설정 : 데이터 입력 시 명시된 값을 지정하지 않는 경우 NULL이 입력되고, DEFAULT 값을 정의했다면 해당 칼럼에는 NULL이 아니라 사전에 정의된 기본 값이 자동으로 입력 됨

**라. 생성된 테이블 확인**

​    \- Oracle : *DESCRIBE 테이블명*

​    \- SQL Server : *sp_help 'dbo.테이블명'*

**마. SELECT 문장을 통한 테이블 생성**

​    \- 칼럼별로 데이터 유형을 다시 재정의하지 않아도 되는 장점

​    \- 제약조건 중 NOT NULL만 복제 테이블에 적용되고, 나머지(PK, FK, UK, CHECK 등) 제약 조건은 없어짐

​    \- 제약조건을 추가하기 위해서는 ALTER TABLE을 사용해야 한다



# 3. ALTER TABLE

\- 칼럼을 추가/삭제하거나 제약조건을 추가/삭제하는 작업



**가. ADD COLUMN**

​    \- 기존 테이블에 필요한 칼럼을 추가하는 명령어

​    \- 구문 : *ALTER TABLE 테이블명 ADD 추가할_칼럼명 데이터유형;*

​    \- 새롭게 추가된 칼럼은 테이블의 마지막 칼럼이 되고, 위치를 지정할 수는 없다

**나. DROP COLUMN**

​    \- 테이블에서 필요 없는 칼럼을 삭제(데이터가 있든 없든)하는 명령어

​    \- 칼럼 삭제는 한 번에 하나의 칼럼만 가능하고, 삭제 후 최소 하나 이상의 칼럼이 테이블에 존재해야 한다

​    \- 구문 : *ALTER TABLE 테이블명 DROP COLUMN 삭제할_칼럼명;*

**다. MODIFY COLUMN**

​    \- 칼럼의 데이터 유형, 디폴트 값, NOT NULL 제약조건에 대한 변경

​    \- 구문(Oracle) : *ALTER TABLE 테이블명 MODIFY (칼럼명1 데이터유형 [DEFAULT식] [NOT NULL], ... );*

​    \- 구문(SQL Server) : *ALTER TABLE 테이블명 ALTER (칼럼명1 데이터유형 [DEFAULT식] [NOT NULL], ... );*

​    \- 칼럼 변경 시 주의사항 : 칼럼의 크기를 늘릴 수 는 있지만 줄이지는 못한다(기존 데이터 훼손 방지, 칼럼이 null 값만 갖거나 아무 행도 없는 상태라면 폭을 줄일 수 있다), 해당 칼럼이 null 값만 가지고 있다면 데이터 유형을 변경할 수 있다, 해당 칼럼의 DEFAULT 값을 바꾸면 변경 작업 이후 발생하는 행 삽입에는 영향을 준다, 해당 칼럼에 NULL 값이 없는 경우에만 NOT NULL 제약조건을 추가할 수 있다

**라. RENAME COLUMN**

​    \- 칼럼명을 변경해야 하는 경우 사용

​    \- 구문 : *ALTER TABLE 테이블명 RENAME COLUMN 변경해야할칼럼명 TO 새로운칼럼명;*

**마. DROP CONSTRAINT**

​    \- 테이블 생성 시 부여했던 제약 조건을 삭제하는 명령어

​    \- 구문 : *ALTER TABLE 테이블명 DROP CONSTRAINT 제약조건명;*

**바. ADD CONSTRAINT**

​    \- 테이블 생성 시 제약조건을 적용하지 않았고, 나중에 필요할 때 추가하는 명령어

​    \- 구문 : *ALTER TABLE 테이블명 ADD CONSTRAINT 제약조건명 제약조건 (칼럼명);*



# 4. RENAME TABLE

​    \- 테이블의 이름을 변경하는 명령어

​    \- 구문 : *RENAME 변경전_테이블명 TO 변경후_테이블명;*



# 5. DROP TABLE

​    \- 테이블을 잘못 만들었거나, 더이상 필요 없을 경우 테이블의 모든 데이터 및 구조를 삭제하는 명령어

​    \- 구문 : *DROP TABLE 테이블명 [CASCADE CONSTRAINT];*

​    \- CASCADE CONSTRAINT 옵션은 해당 테이블과 관계 있던 참초 제약조건에 대해서도 삭제한다는 의미

​    \- SQL Server에서는 테이블을 삭제하기 전 참조되는 FK 제약 조건 또는 참조 테이블을 먼저 삭제해야 한다



# 6. TRUNCATE TABLE

​    \- 해당 테이블에 들어있던 모든 행들이 제거되고 저장 곤간을 재사용하는 것

​    \- 구문 : *TRUNCATE TABLE 테이블명;*

| **DROP**     | 테이블 정의 자체를 완전히 삭제하는 것Rollback 불가능, 테이블이 사용했던 Storage 모두 Release |
| ------------ | ------------------------------------------------------------ |
| **DELETE**   | 테이블 내 데이터만 삭제Commit 이전에는 Rollback 가능, 데이터를 모두 Delete해도 사용했던 Storage는 유지 |
| **TRUNCATE** | 테이블을 최초 생성된 초기 상태로 되돌리는 것Rollback 불가능, 테이블이 사용했던 Storage 중 최초 테이블 생성 시 할당된 부분만 남기고 나머지는 Release |