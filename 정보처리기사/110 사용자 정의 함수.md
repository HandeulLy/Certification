

# [정보처리기사 110] - 사용자 정의 함수 ☆



# **# 사용자 함수 개요**

프로시저와 유사하게 SQL을 사용하여 일련의 작업을 연속 처리하며, 종료 시 처리 결과를 단일 값으로 반환하는 절차형 SQL



· DB에 저장되어 SELECT, INSERT, DELETE, UPDATE 등 DML 문의 호출에 의해 실행된다.

· SELECT를 통한 조회만 가능하고, 테이블 조작(INSERT, DELETE, UPDATE)은 할 수 없다.

· 사용자 정의 함수는 프로시저를 호출해서 사용할 수 없다.

· SUM(), AVG() 등의 내장 함수처럼 DML문에서 반환 값을 활용할 용도로 사용한다.



| **구분**             | **프로시저**                   | **사용자 정의 함수** |
| -------------------- | ------------------------------ | -------------------- |
| **반환값**           | 없는 경우 또는 1개 이상도 가능 | 1개                  |
| **파라미터**         | 입출력 가능                    | 입력만 가능          |
| **사용 가능 명령문** | DML, DCL                       | SELECT               |
| **호출**             | 프로시저, 사용자 정의 함수     | 사용자 정의 함수     |
| **사용 방법**        | 실행문                         | DML에 포함           |



# **# 사용자 함수 구성**

<img src='/img/110_01.png'>

<center>출처 : https://shlee1990.tistory.com/836</center>



· **DECLARE** : 사용자 정의 함수의 명칭, 변수, 인수, 데이터 타입을 정의하는 선언부

· **BEGIN** / **END** : 사용자 정의 함수의 시작과 종료를 의미

· **CONTROL** : 조건문 또는 반복문이 삽입되어 순차적으로 처리 됨

· **SQL** : SELECT 문이 삽입되어 데이터 조회 작업 수행

· **EXCEPTION** : BEGIN ~ END  사이에 발생하는 예외 처리 방법 정의

· **RETURN** : 필수 사항, 호출 프로그램에 반환할 값이나 변수 정의



# **# 사용자 함수 생성~실행~제거**

CREATE [OR REPLACE] FUNCTION 사용자정의함수명(파라미터)

[지역변수 선언]

BEGIN

​    사용자정의함수 BODY;

​    RETURN 반환값;

END;

· CREATE FUNCTION : 사용자 정의 함수 생성 명령어

· OR REPLACE : 동일한 이름의 사용자 정의 함수가 이미 존재한다면 그것을 대체

· 파라미터

​    \- IN : 호출 프로그램이 사용자 정의 함수에게 값을 전달할 때 지정

​    \- 매개변수명 : 호출 프로그램으로부터 전달받은 값을 저장할 변수의 이름을 지정

​    \- 자료형 : 변수의 자료형을 지정

· BODY : 사용자 정의 함수의 코드를 기록하는 부분, BEGIN과 END 사이에 적어도 하나의 SQL문이 있어야 함

· RETURN : 반환할 값이나 반환할 값이 저장된 변수를 호출 프로그램으로 반환



SELECT 사용자정의함수명 FROM 테이블명;

INSERT INTO 테이블명(속성명) VALUES (사용자정의함수명);

DELETE FROM 테이블명 WHERE 속성명=사용자정의함수명;

UPDATE 테이블명 SET 속성명=사용자정의함수명;

사용자 정의 함수 실행 명령어

사용자 정의 함수는 DML에서 속성명이나 값이 놓일 자리를 대체하여 사용된다.



DROP FUNCTION 사용자정의함수명;

사용자 정의 함수 제거 명령어