

# [정보처리기사 109] - 트리거(Trigger) ☆



# **# 트리거 개요**

DB 시스템에서 데이터의 삽입, 갱신, 삭제 등의 이벤트가 발생할 때마다 관련 작업이 자동으로 수행되는 절차형 SQL



· 트리거는 DB에 저장되며, 데이터 변경 및 무결성 유지, 로그 메시지 출력 등의 목적으로 사용된다.

· 트리거 구문에는 DCL을 사용할 수 없고, DCL이 포함된 프로시저나 함수를 호출하는 경우도 오류가 발생한다.

· 트리거에 오류가 있는 경우, 트리거가 처리하는 데이터에도 영향을 주기 때문에 트리거를 생성할 때 세심한 주의가 필요하다.



# **# 트리거 구성**

<img src='/img/109_01.png'>

<center>출처 : https://shlee1990.tistory.com/836</center>



· **DECLARE** : 트리거의 명칭, 변수 및 상수, 데이터 타입을 정의하는 선언부

· **EVENT** : 트리거가 실행되는 조건 명시

· **BEGIN** / **END** : 트리거의 시작과 종료

· **CONTROL** : 조건문 또는 반복문이 삽입되어 순차적으로 처리

· **SQL** : DML 문이 삽입되어 데이터 관리를 위한 조회/추가/수정/삭제 작업 수행

· **EXECPTION** : BEGIN ~ END 안의 구문 실행 시 예외가 발생하면 처리하는 방법 정의



# **# 트리거 생성~제거**

CREATE [OR REPLACE] TRIGGER 트리거명 [동작시기 옵션][동작 옵션] ON 테이블명 REFERENCING [NEW|OLD] AS 테이블명 FOR EACH ROW [WHEN 조건식] BEGIN    트리거 BODY; END;

· CREATE TRIGGER : 트리거 생성 명령어

· OR REPLACE : 동일한 이름의 트리거가 이미 존재하는 경우, 기존 트리거를 대체

· 동작시기 옵션 : 트리거가 실행될 때를 지정, 옵션 BEFORE/AFTER(테이블이 변경되기 전/후에 트리거 실행)

· 동작옵션 : 트리거가 실행되게 할 작업의 종류 지정

​    \- INSERT : 테이블에 새로운 튜플을 삽입할 때 트리거 실행

​    \- DELETE : 테이블의 튜플을 삭제할 때 트리거 실행

​    \- UPDATE : 테이블의 튜플을 수정할 때 트리거 실행

· NEW / OLD : 트리거가 적용될 테이블의 별칭 지정

​    \- NEW : 추가되거나 수정에 참여할 튜플들의 집합(테이블)을 의미

​    \- OLD : 수정되거나 삭제 전 대상이 되는 튜플들의 집합(테이블)을 의미

· FOR EACH ROW : 각 튜플마다 트리거를 적용하는 명령어

· WHEN 조건식 : 트리거를 적용할 튜플의 조건 지정

· 트리거 BODY : 트리거의 본문 코드 부분, BEGIN~END 사이에 적어도 하나 이상의 SQL문이 있어야 함(없으면 에러)



DROP TRIGGER 트리거명;

트리거를 제거하는 명령어